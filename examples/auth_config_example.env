# Enterprise Authentication Configuration Example
# Copy this file to .env and customize for your environment

# =============================================================================
# Basic Authentication Settings
# =============================================================================

# Session configuration
AUTH_SESSION_DURATION_HOURS=24
AUTH_SESSION_CLEANUP_MINUTES=5

# Security settings (set to false only for development)
AUTH_REQUIRE_HTTPS=true
AUTH_SECURE_COOKIES=true
AUTH_CSRF_PROTECTION=true

# Rate limiting
AUTH_RATE_LIMIT_PER_MINUTE=60
AUTH_FAILED_LOGIN_LOCKOUT_MINUTES=15
AUTH_MAX_FAILED_ATTEMPTS=5

# JWT settings
AUTH_JWT_ALGORITHM=HS256
AUTH_JWT_EXPIRATION_MINUTES=60
AUTH_REFRESH_TOKEN_EXPIRATION_DAYS=30

# Provider configuration
AUTH_ENABLED_PROVIDERS=admin_keys,oidc
AUTH_DEFAULT_PROVIDER=admin_keys

# Multi-factor authentication
AUTH_MFA_ENABLED=false
AUTH_MFA_REQUIRED_FOR_ADMIN=true
AUTH_MFA_GRACE_PERIOD_MINUTES=60

# Audit settings
AUTH_AUDIT_ALL_EVENTS=true
AUTH_AUDIT_RETENTION_DAYS=90

# =============================================================================
# Identity Provider Configurations
# =============================================================================

# Generic OIDC Provider
# Uncomment and configure for generic OIDC provider
#OIDC_CLIENT_ID=your_client_id
#OIDC_CLIENT_SECRET=your_client_secret
#OIDC_DISCOVERY_URL=https://your-provider.com/.well-known/openid_configuration
#OIDC_ISSUER=https://your-provider.com
#OIDC_AUDIENCE=your_audience
#OIDC_REDIRECT_URI=https://your-atp-instance.com/auth/callback/oidc
#OIDC_MFA_REQUIRED=false

# Okta Configuration
# Uncomment and configure for Okta integration
#OKTA_CLIENT_ID=your_okta_client_id
#OKTA_CLIENT_SECRET=your_okta_client_secret
#OKTA_DOMAIN=your-company.okta.com
#OKTA_AUDIENCE=api://default
#OKTA_REDIRECT_URI=https://your-atp-instance.com/auth/callback/okta
#OKTA_MFA_REQUIRED=false

# Azure AD Configuration
# Uncomment and configure for Azure AD integration
#AZURE_CLIENT_ID=your_azure_client_id
#AZURE_CLIENT_SECRET=your_azure_client_secret
#AZURE_TENANT_ID=your_tenant_id_or_common
#AZURE_AUDIENCE=your_audience
#AZURE_REDIRECT_URI=https://your-atp-instance.com/auth/callback/azure_ad
#AZURE_MFA_REQUIRED=false

# Auth0 Configuration
# Uncomment and configure for Auth0 integration
#AUTH0_CLIENT_ID=your_auth0_client_id
#AUTH0_CLIENT_SECRET=your_auth0_client_secret
#AUTH0_DOMAIN=your-company.auth0.com
#AUTH0_AUDIENCE=your_audience
#AUTH0_REDIRECT_URI=https://your-atp-instance.com/auth/callback/auth0
#AUTH0_MFA_REQUIRED=false

# =============================================================================
# Legacy Admin Keys (Backward Compatibility)
# =============================================================================

# Admin API keys for backward compatibility
# Format: key1:role1+role2,key2:role3+role4
# Roles: read, write, admin
ROUTER_ADMIN_KEYS=CHANGE_ME_TO_SECURE_KEY:read+write+admin

# Single admin key (legacy format)
#ROUTER_ADMIN_API_KEY=your_single_admin_key

# =============================================================================
# JWKS Configuration (for JWT validation)
# =============================================================================

# JWKS configuration for JWT validation
# Use either JWKS_JSON (inline) or JWKS_PATH (file path)
#JWKS_JSON={"keys":[...]}
#JWKS_PATH=/path/to/jwks.json
#JWKS_TTL_S=300

# =============================================================================
# Development Settings
# =============================================================================

# For development only - disable security features
# DO NOT USE IN PRODUCTION
#AUTH_REQUIRE_HTTPS=false
#AUTH_SECURE_COOKIES=false
#AUTH_CSRF_PROTECTION=false

# =============================================================================
# Example Provider Configurations
# =============================================================================

# Example: Google Workspace (via OIDC)
#OIDC_CLIENT_ID=your_google_client_id.apps.googleusercontent.com
#OIDC_CLIENT_SECRET=your_google_client_secret
#OIDC_DISCOVERY_URL=https://accounts.google.com/.well-known/openid_configuration
#OIDC_ISSUER=https://accounts.google.com
#OIDC_AUDIENCE=your_google_client_id.apps.googleusercontent.com
#OIDC_REDIRECT_URI=https://your-atp-instance.com/auth/callback/oidc

# Example: Microsoft 365 (via Azure AD)
#AZURE_CLIENT_ID=your_azure_app_id
#AZURE_CLIENT_SECRET=your_azure_client_secret
#AZURE_TENANT_ID=your_tenant_id
#AZURE_REDIRECT_URI=https://your-atp-instance.com/auth/callback/azure_ad

# Example: Keycloak (via OIDC)
#OIDC_CLIENT_ID=atp-client
#OIDC_CLIENT_SECRET=your_keycloak_client_secret
#OIDC_DISCOVERY_URL=https://your-keycloak.com/auth/realms/your-realm/.well-known/openid_configuration
#OIDC_ISSUER=https://your-keycloak.com/auth/realms/your-realm
#OIDC_AUDIENCE=atp-client
#OIDC_REDIRECT_URI=https://your-atp-instance.com/auth/callback/oidc