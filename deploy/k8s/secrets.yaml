apiVersion: v1
kind: Secret
metadata:
  name: atp-secrets
  namespace: atp-system
  labels:
    app: atp
type: Opaque
stringData:
  # Database connection
  database-url: "postgresql://atp:CHANGE_ME@postgres:5432/atp"
  
  # Redis connection
  redis-url: "redis://redis:6379"
  
  # API Keys (these should be set via external secret management)
  openai-api-key: "CHANGE_ME"
  anthropic-api-key: "CHANGE_ME"
  google-api-key: "CHANGE_ME"
  
  # JWT signing key
  jwt-secret: "CHANGE_ME_TO_RANDOM_STRING"
  
  # Encryption keys
  encryption-key: "CHANGE_ME_TO_32_BYTE_KEY"
---
apiVersion: v1
kind: ConfigMap
metadata:
  name: atp-config
  namespace: atp-system
  labels:
    app: atp
data:
  # Application configuration
  app.yaml: |
    environment: production
    debug: false
    
    # Logging configuration
    logging:
      level: INFO
      format: json
    
    # Rate limiting
    rate_limiting:
      enabled: true
      requests_per_minute: 1000
      burst_size: 100
    
    # Security
    security:
      cors_enabled: true
      cors_origins: ["https://yourdomain.com"]
      csrf_protection: true
    
    # Monitoring
    monitoring:
      metrics_enabled: true
      tracing_enabled: true
      health_check_interval: 30
  
  # Prometheus configuration
  prometheus.yml: |
    global:
      scrape_interval: 15s
      evaluation_interval: 15s
    
    scrape_configs:
    - job_name: 'atp-services'
      kubernetes_sd_configs:
      - role: pod
        namespaces:
          names:
          - atp-system
      relabel_configs:
      - source_labels: [__meta_kubernetes_pod_annotation_prometheus_io_scrape]
        action: keep
        regex: true
      - source_labels: [__meta_kubernetes_pod_annotation_prometheus_io_path]
        action: replace
        target_label: __metrics_path__
        regex: (.+)
      - source_labels: [__address__, __meta_kubernetes_pod_annotation_prometheus_io_port]
        action: replace
        regex: ([^:]+)(?::\d+)?;(\d+)
        replacement: $1:$2
        target_label: __address__