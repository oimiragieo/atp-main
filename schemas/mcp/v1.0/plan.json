{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://atp-project/schemas/mcp/v1.0/plan.json",
  "title": "MCP Plan Message Schema",
  "description": "Schema for MCP plan messages containing execution plans",
  "type": "object",
  "properties": {
    "type": {
      "type": "string",
      "const": "plan",
      "description": "Message type identifier"
    },
    "toolCallId": {
      "type": "string",
      "description": "Unique identifier for the tool call this plan relates to"
    },
    "plan": {
      "type": "object",
      "description": "Execution plan details",
      "properties": {
        "description": {
          "type": "string",
          "description": "Human-readable description of the plan"
        },
        "steps": {
          "type": "array",
          "description": "Array of execution steps",
          "items": {
            "type": "object",
            "properties": {
              "step_id": {
                "type": "string",
                "description": "Unique identifier for this step"
              },
              "description": {
                "type": "string",
                "description": "Description of this step"
              },
              "tool": {
                "type": "string",
                "description": "Tool to be executed in this step"
              },
              "parameters": {
                "type": "object",
                "description": "Parameters for the tool execution",
                "additionalProperties": true
              },
              "estimated_tokens": {
                "type": "integer",
                "minimum": 0,
                "description": "Estimated token count for this step"
              }
            },
            "required": ["step_id", "description"]
          }
        },
        "estimated_total_tokens": {
          "type": "integer",
          "minimum": 0,
          "description": "Total estimated token count for the entire plan"
        },
        "model_selected": {
          "type": "string",
          "description": "Model selected for execution"
        }
      },
      "required": ["description", "steps"]
    },
    "roles": {
      "type": "array",
      "description": "Roles involved in the execution (for experiment metadata)",
      "items": {
        "type": "object",
        "properties": {
          "role": {
            "type": "string",
            "enum": ["champion", "challenger"],
            "description": "Role type"
          },
          "model": {
            "type": "string",
            "description": "Model name for this role"
          },
          "confidence": {
            "type": "number",
            "minimum": 0,
            "maximum": 1,
            "description": "Confidence score for this role"
          }
        },
        "required": ["role", "model"]
      }
    }
  },
  "required": ["type", "toolCallId", "plan"]
}
